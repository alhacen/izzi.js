"use strict";class izzi{allNodes=[];izziNodes=[];iCompNodes=[];constructor(t,e){this.izData=t,e&&(this.compName=e.compName,this.props=e.props,console.log(this.compName,this.props))}loop=t=>{for(var e=t.childNodes,a=0;a<e.length;a++)e[a]&&("IZZI"!==e[a].nodeName?"ICOMP"!==e[a].nodeName?(0<e[a].childNodes.length&&this.loop(e[a]),this.allNodes.push({nodeName:e[a].nodeName,node:e[a]})):this.iCompNodes.push(e[a]):this.izziNodes.push(e[a]))};parseVar(t){for(var e=/\{\{(.*?)\}\}/g,a=[],i=e.exec(t);null!=i;)a.push(i[1]),i=e.exec(t);return a}linkData=(e,t,a,i,s=null)=>{let r,n;t.map(t=>{e=e.replaceAll(`{{${t}}}`,"${"+t+"}")}),t.map(t=>{r=new Function("props",`return ${t.substr(0,t.indexOf("."))}`)(this.props),"izziState"!==r?.type&&(r=new Function("props",`return ${t}`)(this.props)),n="izziState"===r?.type?r.id:t,"props."===t.substr(0,6)&&(console.log(e),n=`${this.compName}.${t.substr(6)}`),this.izData.get(n)||this.izData.set(n,[]),this.izData.get(n).push({element:a,tagType:i,...s&&{attributeType:s},template:("izziTag"===i?new Function("props","return ()=>{return "+e.trim()+"}"):new Function("props","return ()=>{return `"+e+"`}"))(this.props)})})};escapeHTML=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");unEscapedHTML=t=>{let e=document.createElement("textarea");return e.innerHTML=t.innerHTML,window.a=e.defaultValue.trim(),e.defaultValue.trim()};initIzziTag=()=>{let e;this.izziNodes.map(t=>{e=t.getAttribute("bind")?.split(","),e=e||[""],e?.length&&this.linkData(this.unEscapedHTML(t),e,t,"izziTag")})};initMagicTag=()=>{let s;this.allNodes.map(t=>{var i=t.node;if(i.data){let t;t=i.data,t=t.replace(/\s+/g," "),s=this.parseVar(t),s.length&&this.linkData(t,s,i,"magicTag")}if(i.attributes)for(let a=0;a<i.attributes.length;a++){let t,e;t=i.attributes[a].value,t=t.replace(/\s+/g," "),e=i.attributes[a].name,s=this.parseVar(i.attributes[a].value),s.length&&this.linkData(t,s,i,"magicTagAttribute",e)}})};getAllAttributes=a=>a.getAttributeNames().reduce((t,e)=>({...t,[e]:a.getAttribute(e)}),{});initIcomp=()=>{this.iCompNodes.map(e=>{e.style.display="none";let s=e.getAttribute("name");[...document.querySelectorAll(s)].map(a=>{var t={children:a.innerHTML};a.innerHTML=e.innerHTML;let i={...this.getAllAttributes(a),...t};Object.keys(i).map(t=>{var e=i[t].replace(/\s+/g," "),t=this.parseVar(e);this.linkData(e,t,a,"magicProps")}),init(a,{compName:s,props:{...this.getAllAttributes(a),...t}})})})}}const setStateTostateMap=new Map,izData=new Map,useState=t=>{let e={type:"izziState",id:setStateTostateMap.size,state:t,set:t=>{e.state=t,render(e.id)},get:()=>e.state};return setStateTostateMap.set(setStateTostateMap.size,e),e},renderHTML=t=>{izData.get(t)?.map(t=>{let e=t.template();e=Array.isArray(e)?e.join(""):"object"==typeof e?JSON.stringify(e):e,"magicTag"===t.tagType?t.element.textContent=e:"izziTag"===t.tagType?t.element.innerHTML=e:"magicTagAttribute"===t.tagType&&("value"===t.attributeType?t.element.value=e:t.element.setAttribute(t.attributeType,e))})},render=(t=null)=>{null===t?[...izData.keys()].map(t=>{renderHTML(t)}):renderHTML(t)},init=async(t,e)=>{let a=new izzi(izData,e);window.z=a,a.loop(t),a.initMagicTag(),a.initIzziTag(),a.initIcomp(),render()};